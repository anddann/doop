#include "macros.logic"
#include "../library/common-delta.logic"

/**
 * Special calling contexts
 *
 * Note: the type is necessary (java.lang.String), but never used. It
 * could be anything. It also needs to be an existing type, otherwise
 * the sanity checks will barf.
 */
PlusHeapAllocation(?heap, "<<initial-context>>", "java.lang.String").
PlusHeapAllocation(?heap, "<<jvm-startup>>", "java.lang.String").
PlusHeapAllocation(?heap, "<<class-initialization>>", "java.lang.String").
PlusHeapAllocation(?heap, "<<immutable>>", "java.lang.String").

/* used only for Paddle compatibility */
PlusHeapAllocation(?heap, "<<no-context>>", "java.lang.String").

/**
 * Special objects, ?heap is a heap object used only as context
 */
+MySystemThreadGroup(?heap, ?alloc),
#ifdef PADDLE_COMPAT
  PlusHeapAllocation(?heap, "<<no-context>>", "java.lang.String"),
#else
  PlusHeapAllocation(?heap, "<<jvm-startup>>", "java.lang.String"),
#endif
  PlusHeapAllocation(?alloc, "<<system-thread-group>>", "java.lang.ThreadGroup").

+MyMainThreadGroup(?heap, ?alloc),
#ifdef PADDLE_COMPAT
  PlusHeapAllocation(?heap, "<<no-context>>", "java.lang.String"),
#else
  PlusHeapAllocation(?heap, "<<jvm-startup>>", "java.lang.String"),
#endif
  PlusHeapAllocation(?alloc, "<<main-thread-group>>", "java.lang.ThreadGroup").

+MyMainThread(?heap, ?alloc),
#ifdef PADDLE_COMPAT
  PlusHeapAllocation(?heap, "<<no-context>>", "java.lang.String"),
#else
  PlusHeapAllocation(?heap, "<<jvm-startup>>", "java.lang.String"),
#endif
  PlusHeapAllocation(?alloc, "<<main-thread>>", "java.lang.Thread").
